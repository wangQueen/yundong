
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="description" content="浏览器通知Web Notifications » 张鑫旭-鑫空间-鑫生活" />
<meta name="description" content="张鑫旭web前端学习实例页面之浏览器通知Web Notifications" />
<meta name="keywords" content="Web Notifications, HTML5" />
<meta name="author" content="张鑫旭, zhangxinxu" />
<title>浏览器通知Web Notifications » 张鑫旭-鑫空间-鑫生活</title>
<link rel="stylesheet" href="../css/demo.css" type="text/css" />
<link rel="stylesheet" href="../css/hl.css" type="text/css" />
</head>

<body>
<div id="header">
	<a href="/" class="logo" title="回到鑫空间-鑫生活首页">
    	<img alt="张鑫旭-鑫空间-鑫生活" src="http://www.zhangxinxu.com/php/image/zxx_home_logo.png" border="0" height="37" />
    </a>
</div>
<div id="main">
	<h1>浏览器通知Web Notifications实例页面</h1>
    <a href="http://www.zhangxinxu.com/wordpress/?p=5474" id="back">回到相关文章 &raquo;</a>
    <div id="body">
    	<div id="code" class="part">
        	<h3>代码：</h3>
            <div class="show">
                <h5>HTML代码：</h5>
                <pre name="code" class="html">
&lt;button id="button"&gt;有人想加你为好友&lt;/button&gt;
&lt;p id="text"&gt;&lt;/p&gt;
                </pre>
                <h5>JS代码：</h5>
                <pre name="code" class="js">
if (window.Notification) {
    var button = document.getElementById('button'), text = document.getElementById('text');
    
    var popNotice = function() {
        if (Notification.permission == "granted") {
            var notification = new Notification("Hi，帅哥：", {
                body: '可以加你为好友吗？',
                icon: 'http://image.zhangxinxu.com/image/study/s/s128/mm1.jpg'
            });
            
            notification.onclick = function() {
                text.innerHTML = '张小姐已于' + new Date().toTimeString().split(' ')[0] + '加你为好友！';
                notification.close();    
            };
        }    
    };
    
    button.onclick = function() {
        if (Notification.permission == "granted") {
            popNotice();
        } else if (Notification.permission != "denied") {
            Notification.requestPermission(function (permission) {
              popNotice();
            });
        }
    };
} else {
    alert('浏览器不支持Notification');    
}
                </pre>
            </div>
        </div>
        <div id="effect" class="part">
        	<h3>效果：</h3>
            <div class="show">
            	<div class="demo">
                	<button id="button">有人想加你为好友</button>
                    <p id="text"></p>
                </div>
            </div>
        </div>       
    </div>
</div>

<script>
if (window.Notification) {
	var button = document.getElementById('button'), text = document.getElementById('text');
	
	var popNotice = function() {
		if (Notification.permission == "granted") {
			var notification = new Notification("Hi，帅哥：", {
				body: '可以加你为好友吗？'	,
				icon: 'http://image.zhangxinxu.com/image/study/s/s128/mm1.jpg'
			});
			
			notification.onclick = function() {
				text.innerHTML = '张小姐已于' + new Date().toTimeString().split(' ')[0] + '加你为好友！';
				notification.close();	
			};
		}	
	};
	
	button.onclick = function() {
		if (Notification.permission == "granted") {
			popNotice();
		} else if (Notification.permission != "denied") {
			Notification.requestPermission(function (permission) {
			  popNotice();
			});
		}
	};
} else {
	alert('浏览器不支持Notification');	
}
</script>



</body>
</html>
